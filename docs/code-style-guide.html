<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Bono Usu</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Bono Usu">
  <meta name="generator" content="bookdown 0.1 and GitBook 2.6.7">

  <meta property="og:title" content="Bono Usu" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bono Usu" />
  
  
  

<meta name="author" content="Jon Calder &amp; Lorenz Walthert">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction.html">
<link rel="next" href="workflow-collaboration.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="code-style-guide.html"><a href="code-style-guide.html"><i class="fa fa-check"></i><b>2</b> Code style guide</a><ul>
<li class="chapter" data-level="2.1" data-path="code-style-guide.html"><a href="code-style-guide.html#naming"><i class="fa fa-check"></i><b>2.1</b> Naming</a><ul>
<li class="chapter" data-level="2.1.1" data-path="code-style-guide.html"><a href="code-style-guide.html#naming-files"><i class="fa fa-check"></i><b>2.1.1</b> Naming files</a></li>
<li class="chapter" data-level="2.1.2" data-path="code-style-guide.html"><a href="code-style-guide.html#naming-objects"><i class="fa fa-check"></i><b>2.1.2</b> Naming objects</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="code-style-guide.html"><a href="code-style-guide.html#assignment"><i class="fa fa-check"></i><b>2.2</b> Assignment</a></li>
<li class="chapter" data-level="2.3" data-path="code-style-guide.html"><a href="code-style-guide.html#quotes"><i class="fa fa-check"></i><b>2.3</b> Quotes</a></li>
<li class="chapter" data-level="2.4" data-path="code-style-guide.html"><a href="code-style-guide.html#line-indention"><i class="fa fa-check"></i><b>2.4</b> Line indention</a></li>
<li class="chapter" data-level="2.5" data-path="code-style-guide.html"><a href="code-style-guide.html#nested-code"><i class="fa fa-check"></i><b>2.5</b> Nested code</a></li>
<li class="chapter" data-level="2.6" data-path="code-style-guide.html"><a href="code-style-guide.html#conditional-statements"><i class="fa fa-check"></i><b>2.6</b> Conditional statements</a></li>
<li class="chapter" data-level="2.7" data-path="code-style-guide.html"><a href="code-style-guide.html#argument-specification"><i class="fa fa-check"></i><b>2.7</b> Argument specification</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workflow-collaboration.html"><a href="workflow-collaboration.html"><i class="fa fa-check"></i><b>3</b> Workflow &amp; collaboration</a></li>
<li class="chapter" data-level="4" data-path="package-development.html"><a href="package-development.html"><i class="fa fa-check"></i><b>4</b> Package development</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bono Usu</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="code-style-guide" class="section level1">
<h1><span class="header-section-number">2</span> Code style guide</h1>
<p>This chapter deals mostly with low-level coding style. Every section starts with a code chunk to quickly highlight the principle of that section. Depending on how strongly we agree/disagree with a certain practice, we use <code># good / bad</code> or <code># advised / discouraged</code> to indicate the importance of adhering to a certain style.<br />
<br />
After the summary, the pros and cons of certain approaches are discussed in more depth.</p>
<div id="naming" class="section level2">
<h2><span class="header-section-number">2.1</span> Naming</h2>
<div id="naming-files" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Naming files</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good</span>
reduce_matrix.R
<span class="co"># bad</span>
rM_1.r</code></pre></div>
<p>At the point of creating files, it is important to choose a good name. The same applies for the directory where it is stored. Changing the name or location of a file later can cause a number of problems:</p>
<ul>
<li>outdated dependencies due to invalid paths.</li>
<li>removed history in the version control system (e.g. not with <code>git mv</code>)if renaming is not done properly. <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></li>
<li>discontinuity in the history. It is hard to find renamed files.</li>
<li>processes that take the file name as an input and return an output that is related to this name are problematic. For example, when creating an html file from an Rmd file via <code>knitr()</code>, the created object has the same name (but a different suffix) as the Rmd file. If you change the name, the old html file will still be there but a new html file with the new name will also be there. Most likely, you need to clean up manually.</li>
</ul>
<p>Hence, you should avoid renaming files if possible. When naming files, the following considerations are worth taking into account:</p>
<ul>
<li>Sometimes, there are restrictions in place for file names (e.g. the package <code>testthat</code> used in package development requires that all files pertaining to testing start with “test” and live in a particular folder).</li>
<li>Do use expressive but concise names. Describe the function of the file (<code>clean_temperature_data.R</code>), what it inputs or outputs (<code>daily_to_monthly_transformation.R</code>), how it relates to other files (e.g. <code>helper_sort.R</code> is a helper function for a sort routine) and so on.</li>
<li>Do not use version numbers in the file name. Use a version control system like git instead.</li>
<li>Use all lower case names. One motivation for this is that it can save keystrokes and improving typing efficiency. Possibly more important though is that when recalling functions (given that R is case-sensitive), either yourself or other R developers and users will have a harder time remembering what case you used for a function name. Instead of using camelCase, separate elements of the name with an underscore.</li>
<li>It can be advantageous to use a combination of numbers and descriptive words as a file name. This allows you to a) select files efficiently with bash or even keyboard navigation in a user interface and b) can be informative if you want to maintain a certain order of the files (e.g. if scripts have to be run in a certain) order. However, note that if you use this system, you need to change the name of files if you want to insert an element at a position other than the end of the sequence.</li>
<li>Since some systems are not case-sensitive, do not use file names that only differ in the case of the characters (e.g. <code>readme.md</code> and <code>README.md</code>).</li>
<li>Choose unique file names, even across directories. This avoids confusion and allows you to find the file you are looking for very quickly with a search function or <em>go to</em> command such as the one in RStudio.</li>
<li>Try to avoid using special characters (like ?, \ etc.) since they are not allowed, can cause compatibility issues, need to be escaped and so forth.</li>
<li>Files with extremely long names might be very expressive, but that comes at a cost: they are not memorable, often truncated for displaying and hence not really helpful anymore.</li>
<li>Short and concise names are preferable but do refrain from using abbreviations since that makes it hard for people to understand them if they lack prior or implicit knowledge about your code. If it is absolutely inevitable, provide a dictionary and a reference to it in the readme file.</li>
<li>stick to a format if the content you are naming has one i.e. if your files refer to specific dates or times, always use the same representation, e.g YYMMDD. Other examples are names (firstname_lastname).</li>
<li>Do not use synonyms, mix British or American English etc.</li>
<li>Always use the same case for file extensions. Although <code>xzy.r</code> and <code>xyz.R</code> are both recognized as R files, we recommend the latter.</li>
</ul>
<p>To sum it up, here are a couple of bad examples for the cases described above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># version number in file name</span>
cleaning_3.R
<span class="co"># special character</span>
is_it_correct<span class="st">&#39;.Rmd</span>

<span class="st"># length</span>
<span class="st">this_name_is_expressive_but_will_always_be_truncated_and_hence_useless.pdf</span>
<span class="st"># (uncommon) abbreviations</span>
<span class="st">vp8rm_fs.R</span></code></pre></div>
<p>Do not use these pairs of examples simultaneously.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># avoid synonyms</span>
quick_data_check.R 
fast_data_check.R
<span class="co"># stick to one format</span>
<span class="dv">2016-02</span>-15_tidy.RDS
15_Feb2016.csv</code></pre></div>
<p>On the other hand, these file names meet the criteria outlined before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lower case names</span>
showcase_outlier.Rmd
<span class="co"># underscore as a separator</span>
combine_a_and_b.R
<span class="co"># files in order</span>
<span class="dv">01</span>-get_data.R
<span class="dv">02</span>-clean_data.R
<span class="dv">03</span>-visualize_data.R
<span class="co"># uppercase extension for R</span>
for_mint.R</code></pre></div>
</div>
<div id="naming-objects" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Naming objects</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good</span>
reduce_matrix <span class="co"># for a function</span>
reduced_matrix <span class="co"># for a variable</span>
<span class="co"># bad</span>
convert.characters <span class="co"># resembles S3 method</span></code></pre></div>
<p>A lot of rules that were described in the above section apply for naming objects (in the sense of bindings within namespaces) as well. In particular we would like to highlight the following:</p>
<ul>
<li>use verbs for functions and nouns for variables. This helps you distinguish objects into categories.</li>
<li>do not use the dot within object names. It gives them the appearance of methods</li>
<li>Avoid function names and variable names that already exist or have a particular meaning. For example, <code>data()</code> is a function in base R, so it might be easier to call your data <code>x</code>, <code>dta</code>, <code>raw</code> etc. Here are a couple of other examples of bad R object names.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># bad</span>
F &lt;-<span class="st"> </span><span class="ot">NULL</span>
list &lt;-<span class="st"> &quot;not an actual list&quot;</span>
mean &lt;-<span class="st"> &quot;I mean he is not nice, he is quite the opposite&quot;</span>
sum &lt;-<span class="st"> </span>function(...) <span class="kw">summarize</span>(...)</code></pre></div>
<ul>
<li>Think about how scoping rules might affect your code and name wisely.</li>
</ul>
</div>
</div>
<div id="assignment" class="section level2">
<h2><span class="header-section-number">2.2</span> Assignment</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good</span>
a &lt;-<span class="st"> </span><span class="dv">2</span>
<span class="co"># bad </span>
a =<span class="st"> </span><span class="dv">2</span></code></pre></div>
<p>Although programmers coming from other languages may not immediately see the benefit of using the so called <em>assignment operator</em> instead of the equals sign, the main advantage is that that an <em>asignment context</em> can be distinguished with ease from other contexts, for example from a function call, from a list creation and from a comparison of two objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="ot">TRUE</span>)
<span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>:<span class="dv">3</span>, 
     <span class="dt">b =</span> <span class="kw">sample</span>(letters[<span class="dv">1</span>:<span class="dv">4</span>]))
a ==<span class="st"> </span>b</code></pre></div>
</div>
<div id="quotes" class="section level2">
<h2><span class="header-section-number">2.3</span> Quotes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># advised</span>
<span class="st">&quot;double quotes&quot;</span>
<span class="co"># discouraged</span>
<span class="st">&#39;single quotes&#39;</span></code></pre></div>
<p>In R, both double quotes and single quotes are available. The advantage of single quotes is that they result in a slightly cleaner visual representation of the code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="st">&#39;this is nice&#39;</span>); <span class="kw">print</span>(<span class="st">&quot;this is a bit less clean&quot;</span>)</code></pre></div>
<p>On the other hand, double quotes can be used to enclose single quotes, whereas the reverse is not possible. This can be useful to create a string like the following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">varname &lt;-<span class="st"> &quot;index&quot;</span>
found &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;n&#39;t &quot;</span>, <span class="st">&quot;&quot;</span>), <span class="dt">size =</span> <span class="dv">1</span>)
<span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;the variable &#39;&quot;</span>, varname, <span class="st">&quot;&#39; was&quot;</span>, found, <span class="st">&quot; found&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</code></pre></div>
<p>Note that in this example, single quotes behave just like any other character. Hence, is not necessary to <em>close</em> an open single quote. This allows us to also use them as contraction in <code>varname</code> without escape. Depending on whether or not compatibility with other programming languages is required, double quotes are probably also a safer option in certain cases.<br />
<br />
For these reasons, we advise the use of double quotes, so all strings are wrapped in the same type of quotes.</p>
</div>
<div id="line-indention" class="section level2">
<h2><span class="header-section-number">2.4</span> Line indention</h2>
<p>Indenting code makes it more legible. For example, you can see where a conditional statement starts and where it ends.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good </span>
if(condition ==<span class="st"> </span><span class="ot">TRUE</span>){
  <span class="co"># quite a bit of code</span>
  <span class="co"># ...</span>
  if(another_condition ==<span class="st"> </span><span class="ot">FALSE</span>){
    <span class="co"># we are going even deeper...</span>
  }
} else {
  <span class="co"># another block of code</span>
}</code></pre></div>
<p>Proper spacing is related to indention and helps if a lot of consecutive lines are similar but not exactly the same. Below, the difference of the two lines can be spotted pretty much immediately.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good</span>
big_range   &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>,   <span class="dt">size =</span> <span class="dv">1</span>,   <span class="dt">replace =</span> <span class="ot">FALSE</span>)
small_range &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>That is because some extra space was added in certain places. Without this extra spaces, the code would look less compact.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># bad</span>
big_range &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
small_range &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Another place to make use of indention is when vectors are created</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good</span>
height &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">Daniel =</span> <span class="fl">1.98</span>,
               <span class="dt">Melody =</span> <span class="fl">1.69</span>,
               <span class="dt">Peter  =</span> <span class="fl">1.87</span>)</code></pre></div>
<p>There are two ways to indent: either using tabs or using spaces. We suggest two spaces for indention, but in certain cases as the last example, it might be wise to use a more flexible indention rule, i.e. to allow all elements of the list to appear exactly in line.<br />
For RStudio users: By default, RStudio inserts spaces when you type tabs, so you can have the best of both worlds. If you prefer to press tab instead of spaces, just make sure that RStudio inserts the same amount of spaces as other people you collaborate with use. Otherwise, it will mess up the indention. Regarding the more flexible indention mentioned above, RStudio takes care of that too.</p>
</div>
<div id="nested-code" class="section level2">
<h2><span class="header-section-number">2.5</span> Nested code</h2>
<p>Line indention are great, but if you hit the third level of nesting, you should maybe consider an approach that does not require so many sub-levels of code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># bad</span>
if(x ==<span class="st"> </span>T){
  for(i in <span class="dv">4</span>:<span class="dv">13</span>){
    if(z[i] ==<span class="st"> </span>T){
      <span class="co"># ...</span>
    } else if(t ==<span class="st"> </span>T){
<span class="co"># .... </span></code></pre></div>
<p>In many cases, you can use functions to avoid nesting, in certain cases, the specific functions you want to create are <em>recursive functions</em>.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> A great way to get rid of nested code related to for loops is to replace them with functionals. We do not want to dive into that further here, since Hadley Wickham’s book <a href="http://adv-r.had.co.nz/Functionals.html">Advanced R</a> covers the material quite nicely. However, let us just quickly discuss an example in the context of good style.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good</span>
<span class="kw">lapply</span>(mtcars, class)
<span class="co"># bad</span>
for(i in <span class="kw">seq_len</span>(<span class="kw">ncol</span>(mtcars))){
  <span class="kw">print</span>(<span class="kw">class</span>(mtcars[, i]))
}</code></pre></div>
<p>Note that using a functional reduced the complexity of the code dramatically, which is certainly beneficial in terms of style. Next, let us consider a functional that uses an anonymous function.<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> One has to take a second glance to realize that the anonymous function is wrapped into another function. Also, note the expression <code>character(1)</code> that is supplied an argument of <code>vapply</code> and does not belong to the anonymous function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">as.list</span>(<span class="dv">1</span>:<span class="dv">12</span>)
<span class="kw">vapply</span>(x, function(r){
    if(r ==<span class="st"> </span><span class="dv">12</span>){
      <span class="kw">print</span>(<span class="st">&quot;this is 12&quot;</span>)
    } else {
      <span class="kw">print</span>(<span class="st">&quot;not 12&quot;</span>)
    }
  }, <span class="kw">character</span>(<span class="dv">1</span>)) </code></pre></div>
</div>
<div id="conditional-statements" class="section level2">
<h2><span class="header-section-number">2.6</span> Conditional statements</h2>
<p>Much has been written about conditional statements. Since they are such an essential element of R programming and programming in general, it should be part of this book. In principal, R lets you write a whole <em>if-else-statement</em> in one line. That is four times less than using the verbose form. In the light of these, relationships, it might be ok to use the <em>one-liner</em> for very short statements.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># concise</span>
if(fail ==<span class="st"> </span><span class="ot">FALSE</span>) <span class="kw">message</span>(<span class="st">&quot;hi&quot;</span>) else <span class="kw">message</span>(<span class="st">&quot;bye&quot;</span>)
<span class="co"># verbose</span>
if(fail ==<span class="st"> </span><span class="ot">TRUE</span>) {
  <span class="kw">message</span>(<span class="st">&quot;hi&quot;</span>) 
} else {
  <span class="kw">message</span>(<span class="st">&quot;bye&quot;</span>)
}</code></pre></div>
<p>Especially for very short conditional statements, you might wan to resort to the function <code>ifelse</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ifelse</span>(fail ==<span class="st"> </span><span class="ot">FALSE</span>, 
       <span class="dt">yes =</span> <span class="st">&quot;the test did fail&quot;</span>, 
       <span class="dt">no  =</span> <span class="st">&quot;the test did not fail&quot;</span>)</code></pre></div>
<p><code>ifelse</code> can also take a vectorized input, which makes it even more usefull to eliminate loops.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>-<span class="dv">3</span>:<span class="dv">4</span>
<span class="co"># good</span>
<span class="kw">sqrt</span>(<span class="kw">ifelse</span>(x &lt;<span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>, x))

<span class="co"># bad </span>
for(i in <span class="kw">seq_along</span>(x)){
  if(x[i] &lt;<span class="st"> </span><span class="dv">0</span>){
    <span class="kw">print</span>(<span class="ot">NA</span>)
  } else {
    <span class="kw">print</span>(<span class="kw">sqrt</span>(x[i]))
  }
}</code></pre></div>
<p><em>If statements</em> can also be used in other contexts:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;the test did&quot;</span>, if(fail ==<span class="st"> </span><span class="ot">FALSE</span>) <span class="st">&quot;not&quot;</span>, <span class="st">&quot;fail&quot;</span>)</code></pre></div>
<p>A very verbose alternative would be:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(fail ==<span class="st"> </span><span class="ot">FALSE</span>){
  <span class="st">&quot;the test did not fail&quot;</span>
} else {
  <span class="st">&quot;the test did fail&quot;</span>
}</code></pre></div>
<p>If the duplication should be avoided, one needs to create a variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(fail ==<span class="st"> </span><span class="ot">FALSE</span>){
  msg &lt;-<span class="st"> &quot;not&quot;</span>
}
<span class="kw">paste</span>(<span class="st">&quot;the test did&quot;</span>, msg, <span class="st">&quot;fail&quot;</span>)
<span class="kw">rm</span>(msg)</code></pre></div>
<p>When an assignment to a variable is conditional, the following is possible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>
<span class="st">  </span>if(fail ==<span class="st"> </span><span class="ot">TRUE</span>) {
    <span class="kw">rpois</span>(<span class="dv">10</span>)
  } else {
    <span class="kw">rnorm</span>(<span class="dv">10</span>)
  }</code></pre></div>
<p>Boolean conditional statements can be abbreviated. The following two <em>if statements</em> are identical.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(!cond){
  <span class="co"># do xyz</span>
}

if(cond ==<span class="st"> </span><span class="ot">FALSE</span>){
  <span class="co"># do xyz</span>
}</code></pre></div>
<p>The functions <code>any</code> and <code>all</code> are also helpful when it comes to conditional statements.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boolean &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), <span class="dv">10</span>, <span class="dt">replace=</span> <span class="ot">TRUE</span>)
<span class="co"># good</span>
if(<span class="kw">all</span>(boolean)){
  <span class="st">&quot;all values are TRUE. That can&#39;t be true.&quot;</span>
} else if(<span class="kw">any</span>(boolean)){
  <span class="st">&quot;at least some values are TRUE. This is quite likely.&quot;</span>
} else {
  <span class="st">&quot;not a single TRUE value?&quot;</span>
}</code></pre></div>
<p>Note that for conditional statements, the order matters if the conditions are not mutually exclusive. In other words, when all values in the above example are <code>TRUE</code>, then also some are. So exchanging the <em>if</em> and the <em>else if</em> statement will never print the message that all values are true, because the first condition already applies. To fix that you could be tempted to do the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>(boolean) &amp;<span class="st"> </span>!<span class="kw">all</span>(boolean)){
  <span class="st">&quot;at least some values are TRUE. This is quite likely.&quot;</span>
} else if(<span class="kw">all</span>(boolean)){
  <span class="st">&quot;all values are TRUE. That can&#39;t be true.&quot;</span>
} else {
  <span class="st">&quot;not a single TRUE value?&quot;</span>
}</code></pre></div>
<p>Obviously, you better do not exchange the conditional statements because this would create redundancy.</p>
<p>Also, lazy evaluation can be useful in combination with conditional statements. For example, you might want to so something within a function based on an input value. However, you do not know whether the value was supplied in the first place. Here are two ways to deal with that situation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good </span>
if(!<span class="kw">missing</span>(x) &amp;&amp;<span class="st"> </span>x &gt;<span class="st"> </span><span class="dv">10</span>) {
  <span class="co"># your code</span>
}
<span class="co"># bad</span>
if(!<span class="kw">missing</span>(x)){
  if(x &gt;<span class="st"> </span><span class="dv">10</span> ){
   <span class="co"># your code </span>
  }
}</code></pre></div>
<p>Finally, an alternative to <em>if statements</em> is the function <code>switch()</code> if the condition is of class character, especially if there are many conditions to test. Note that switch expects a match and returns an invisible <code>NULL</code> if the condition does not match with any option given.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">outcome &lt;-<span class="st"> &quot;excelled&quot;</span>
switch(outcome, 
       <span class="dt">fail  =</span> <span class="st">&quot;the test did fail&quot;</span>, 
       <span class="dt">just_passed =</span> <span class="st">&quot;lucky you&quot;</span>,
       <span class="dt">passed =</span> <span class="st">&quot;the test did not fail&quot;</span>,
       <span class="dt">excelled =</span> <span class="st">&quot;you must be Einstein&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;you must be Einstein&quot;</code></pre>
</div>
<div id="argument-specification" class="section level2">
<h2><span class="header-section-number">2.7</span> Argument specification</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># good</span>
<span class="kw">sample</span>(<span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
<span class="co"># bad </span>
<span class="kw">sample</span>(<span class="dv">100</span>, , <span class="ot">FALSE</span>)</code></pre></div>
<p>Whether and how many arguments you want to name depends on the context. Naming each argument makes the code more accessible for inexperienced R users but makes it also less concise. Also, by definition, you do not need to specify an argument value if you want to adhere to the default. However, sometimes it can increase the legibility to do so, in particular when you want to highlight that you are using a function twice and specify the argument differently.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">case_irrelevant &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;Look&quot;</span>, <span class="st">&quot;the value to look&quot;</span>, <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>)
case_relevant   &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;look&quot;</span>, <span class="st">&quot;the value to look&quot;</span>, <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Regarding the order of the arguments, it is a good convention to stick to the default, even if you name the arguments. How long does it take you to spot the all differences in the following two commands?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># bad</span>
<span class="kw">cut</span>(<span class="dv">3</span>:<span class="dv">19</span>, <span class="dt">breaks =</span> <span class="dv">2</span>, <span class="dt">right =</span> <span class="ot">TRUE</span>, <span class="dt">include.lowest =</span> <span class="ot">FALSE</span>)
<span class="kw">cut</span>(<span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">breaks =</span> <span class="dv">3</span>:<span class="dv">5</span>, <span class="dt">right =</span> <span class="ot">FALSE</span>, <span class="dt">x =</span> <span class="dv">3</span>:<span class="dv">19</span>)</code></pre></div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>See <a href="http://rogerdudler.github.io/git-guide/">this</a> website for a quick introduction to git, a popular version control system.<a href="code-style-guide.html#fnref1">↩</a></p></li>
<li id="fn2"><p>See an example of how to compute a <a href="http://adv-r.had.co.nz/Function-operators.html">fibbonacci series</a><a href="code-style-guide.html#fnref2">↩</a></p></li>
<li id="fn3"><p>See an introduction to anonymous functions in <a href="http://adv-r.had.co.nz/Functional-programming.html#anonymous-functions">Advanced R</a><a href="code-style-guide.html#fnref3">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="workflow-collaboration.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
